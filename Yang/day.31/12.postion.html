<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>百度地图</title>
  <style>
  body,html.#allmap{
    width: 100%;
    height: 100%;
    overflow: hidden;
    margin:0;
    font-family: cursive;
  }
  </style>
<script src="http://api.map.baidu.com/api?v=2.0&ak=bqHWbmgjAXI7THmM4aG0mwmBXS9SX2c9"></script>
</head>
<body>
  <button id="btn">点击获取地图</button>
  <div id="allmap"></div>
  <script type="text/javascript">

var options = {
      enableHighAccuracy: true,
      timeout: 5000,
      maximumAge: 0
    };

    function success(pos) {
      var crd = pos.coords;
      console.log('纬度: ' + crd.latitude);
      console.log('经度: ' + crd.longitude);
      // 百度地图API功能
      var map = new BMap.Map("allmap");    // 创建Map实例
      map.centerAndZoom(new BMap.Point(crd.longitude, crd.latitude), 11);  // 初始化地图,设置中心点坐标和地图级别
      map.addControl(new BMap.MapTypeControl());   //添加地图类型控件
      map.setCurrentCity("北京");          // 设置地图显示的城市 此项是必须设置的
      map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放

    };

    function error(err) {
      console.warn('ERROR(' + err.code + '): ' + err.message);
    };
    var watchId;
    btn.onclick = function(){
      // navigator.geolocation.getCurrentPosition(success,error,option);
       watchId = navigator.geolocation.watchPosition(success,error,option);
       navigator.geolocation.clearWatch(watchId);
    }

  </script>
</body>
</html>
